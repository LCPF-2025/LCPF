import openai
import pandas as pd
import json
import re
import numpy as np

client = openai.OpenAI(api_key='')### input your API key here
def load_data():
    # Load the data from your Excel file (ensure to change the file path if necessary)
    df = pd.read_excel('起訴書例子_竊盜_100.xlsx')
    return df
my_api_key = 'AIzaSyDN8xZLxZelO5SsjP6ZSGPwWraPzxSIa-c'
genai.configure(api_key=my_api_key)

def two_prompt(query):
    prompt = f"""
**請根據以下描述，依照步驟進行分析，並最終從提供的分類清單中選擇一個最適合的大類和小類。**

### 分類清單（請嚴格按照以下分類進行）：

- **個人法益：**【保護個人的基本權利與利益，包括生命、身體、自由、名譽、財產等】

    - **侵害生命：**【危害他人生命權的犯罪行為】
        - **殺人**：故意非法剝奪他人生命，包括直接故意或間接故意致人死亡的行為。
            *加重情節*：對直系血親尊親屬行凶，或伴隨暴力行為、計畫性犯案者。
            *刑期*：處死刑、無期徒刑或十年以上有期徒刑。

        - **過失致死**：因疏忽或未盡注意義務導致他人死亡。
            *加重情節*：在公共場合或高風險環境違規操作導致他人死亡。
            *刑期*：處五年以下有期徒刑、拘役或罰金。
        
        - **傷害致死**：對他人施加傷害，最終導致死亡。
            *加重情節*：未及時提供救助或故意阻礙他人救助，或對無抵抗能力者施暴致死。
            *刑期*：處三年以上十年以下有期徒刑，情節特重可至十五年。
        
        - **遺棄**：遺棄無自救能力者或應扶養之人，使其陷於生命或健康危險。
            *加重情節*：遺棄行為致人死亡，或遺棄身心障礙者、未成年人等特殊群體。
            *刑期*：一般處三年以下有期徒刑、拘役或罰金；若致死，處五年以上有期徒刑。

    - **侵害身體：**【危害他人身體完整性與健康的犯罪行為】
        - **傷害**：非法對他人身體施加傷害，導致肢體損傷或健康受損。
            *加重情節*：若導致重傷或對直系血親尊親屬施暴。
            *刑期*：處五年以下有期徒刑、拘役或罰金。致重傷者處三年以上十年以下有期徒刑​。
        - **重傷害**：造成他人身體嚴重損害，如失明、失聰、毀容、肢體殘廢等永久性傷害。
            *加重情節*：因重傷而導致死亡。
            *刑期*：處五年以上十二年以下有期徒刑，若致死處無期徒刑或十年以上有期徒刑。
        - **過失傷害**：因過失而非故意造成他人身體受傷或健康損害。
            *加重情節*：在公共場合或高風險環境中未遵守安全規範。
            *刑期*：處一年以下有期徒刑、拘役或罰金；致重傷者處三年以下有期徒刑。

    - **侵害自由：**【侵犯他人人身自由與基本權利的犯罪行為】
        - **妨害秘密**：未經同意，非法利用工具或設備窺視、竊聽、錄音、錄影、拍攝或記錄他人非公開的活動、言論、談話或隱私部位，藉此侵犯個人隱私權。
            *加重情節：若利用電腦等科技設備進行，刑期加重至二分之一。
            *刑期：處一年以下有期徒刑、拘役或罰金。
        - **強制**：以強暴、脅迫、藥劑、催眠術等方法使別人做無義務之事，或妨礙他人行使權利。
            *加重情節：對弱勢群體或多人共同實施該行為。
            *刑期：處三年以下有期徒刑、拘役或罰金。
        - **妨害自由**：私行拘禁或以其他非法方法，剝奪人之行動自由者。
            *加重情節：導致被害人死亡或重傷。
            *刑期：一般情況處五年以下有期徒刑、拘役或罰金；致死者處無期徒刑或七年以上有期徒刑。
        - **恐嚇**：以加害生命、身體、自由、名譽、財產之事恐嚇他人，致生危害於安全者。
            *刑期：處二年以下有期徒刑、拘役或九千元以下罰金。
        - **妨害性自主**：違反他人意願而為之性行為，包括強制性交、猥褻等行為。
            *加重情節：對未成年人、殘障人士或攜帶武器進行。
            *一般性行為處三年以上十年以下有期徒刑；符合加重情節者，處七年以上有期徒刑。

    - **侵害名譽信用：**【損害他人社會評價與經濟信用的犯罪行為】
        - **誹謗**：散布不實言論或文字，足以貶損他人名譽或使他人受社會評價降低。
            *加重情節：若以文字、圖畫等形式散布，刑期加重至二分之一。
            *刑期：處一年以下有期徒刑、拘役或一萬五千元以下罰金；若散布文字、圖畫，處二年以下有期徒刑、拘役或三萬元以下罰金。
        - **侮辱**：以言語、文字或行為公然貶低他人人格，損害其尊嚴。
            *加重情節：使用暴力手段侮辱他人。
            *刑期：一般處拘役或九千元以下罰金；使用暴力者處一年以下有期徒刑、拘役或一萬五千元以下罰金​。
        - **妨害信用**：惡意損害他人或企業之商業信用或經濟信用。
            *加重情節：透過電視、網際網路等媒體散布，刑期加重至二分之一。
            *刑期：處二年以下有期徒刑、拘役或科或併科二十萬元以下罰金。

    - **侵害財產：**【非法侵害他人財產權益的犯罪行為】
        - **竊盜**：意圖為自己或第三人不法之所有，竊取他人之動產。
            *加重情節：侵入住宅、攜帶兇器、結夥多人或乘災害之際犯案。
            *刑期：處五年以下有期徒刑、拘役或罰金，加重情節處六月以上五年以下有期徒刑​。
        - **侵占**：意圖為自己或第三人不法之所有，將自己持有他人之物據為己有。
            *加重情節：加重情節：對於公務上或公益所持有的物品犯案。
            *刑期：一般處五年以下有期徒刑、拘役或罰金，加重情節處一年以上七年以下有期徒刑​。
        - **搶奪**：意圖為自己或第三人不法之所有，以當場施強暴或脅迫手段奪取他人財物。
            *加重情節：致人重傷或死亡。
            *刑期：處無期徒刑或七年以上有期徒刑，致人重傷者處三年以上十年以下有期徒刑。
        - **強盜**：意圖為自己或第三人不法之所有，以強暴、脅迫、藥劑、催眠術等方法強取他人財物。
            *加重情節：導致他人重傷、死亡，或伴隨強制性交或擄人勒贖。
            *刑期：處五年以上有期徒刑，致人死亡或重傷可處死刑或無期徒刑。
        - **贓物**：收受、搬運、寄藏、故買贓物或媒介者。因贓物變得之財物，以贓物論。
            *刑期：處五年以下有期徒刑、拘役或科或併科五十萬元以下罰金。
        - **詐欺**：利用欺罔或詐術使人陷於錯誤而交付財物或獲取不法利益。
            *加重情節*：一、冒用政府機關或公務員名義犯了詐欺罪；二、三個或三個以上的人共同參與了一起實施詐欺的行為；三、以廣播電視、電子通訊、網際網路等傳播工具，對公眾散布而犯之；四、以電腦合成、製作關於他人不實影像、聲音之方法犯詐欺罪。
            *刑期*：一般情況處五年以下有期徒刑、拘役或罰金；加重情節處一年以上七年以下有期徒刑。
        - **重利**：收取超過法定利率的高額利息，危害他人財產利益。
            *加重情節：以威脅、暴力等手段強迫他人支付高額利息。
            *刑期：處三年以下有期徒刑、拘役或科或併科九萬元以下罰金。
        - **毀損財產**：故意破壞、損壞他人之動產或不動產。
            *加重情節：毀損公共設施或造成重大經濟損失。
            *刑期：一般情況處二年以下有期徒刑、拘役或罰金。
        - **侵入住宅**：未經合法授權，擅自進入他人住宅，或在他人住宅內逗留。
            *加重情節：無加重情節。
            *刑期：處一年以下有期徒刑、拘役或罰金。
        - **妨害電腦使用**：指未經授權的非法行為，包括無故輸入他人帳號密碼、破解電腦之保護措施、利用系統漏洞或其他方式入侵他人電腦系統或其相關設備。此類行為可能涉及瀏覽、竊取或篡改資料，破壞或干擾電腦設備、網路運作，甚至散播惡意程式（如病毒、木馬程式）、進行分散式阻斷服務（DDoS）攻擊、偽造或操控數據等，導致系統異常或中斷。該行為可能侵犯個人隱私、導致資料外洩或造成重大經濟損失，並涉及法律責任。
            *加重情節：造成他人系統設備或資料永久損毀、資料遺失或資料外洩；對於重要公共系統（如金融、醫療、交通等）進行攻擊或干擾，造成公共安全或大範圍經濟損失；多次或大規模散播惡意程式，對於國家關鍵基礎設施進行攻擊；行為人利用高階科技設備或多重入侵手段進行行為，增加追查困難度。
            *刑期：一般情況處三年以下有期徒刑或科或併科三十萬元以下罰金；加重情節刑期可加重至五年以下有期徒刑，並得併科六十萬以下罰金。

- **社會法益：**【保護社會公共利益與秩序，維護社會正常運作】

    - **侵害公共安全：**【危害社會大眾生命財產安全的犯罪行為】
        - **公共危險**：實施危害不特定多數人生命、身體或財產安全的行為，如縱火、決水、放流毒物、危險駕駛等。
            *加重情節：若因行為致人重傷或死亡，或對重要公共設施、場所施加危險行為。
            *刑期：一般處五年以下有期徒刑、拘役或罰金；若致人於死者，處無期徒刑或七年以上有期徒刑；致重傷者，處三年以上十年以下有期徒刑。
    - **侵害公共信用與交易安全：**【破壞社會經濟秩序與交易安全的犯罪行為】
        - **偽造貨幣**：仿造、變造貨幣或使用偽造之貨幣，破壞國家金融秩序。
            *加重情節：製造假幣流通至大範圍或涉及大額交易。
            *刑期：一般處五年以上有期徒刑，並得併科罰金。
        - **偽造有價證券**：仿造、變造股票、公司債券等有價證券，危害金融交易安全。
            *加重情節：大規模偽造並流通，造成金融損失。
            *刑期：處三年以上十年以下有期徒刑，得併科罰金。
        - **偽造文書**：指偽造或變造各類公文書、私文書以及「準私文書」。「準私文書」包括在紙張、物品上製作或修改的文字、符號、圖畫、照片，亦包含使用錄音、錄影或電磁紀錄等數位媒體表達特定意圖的記錄。此類行為若足以對公眾或他人造成損害，影響文書或記錄的公信力和證據效力，即構成偽造文書罪。
            *加重情節：偽造政府公文。
            *刑期：一般處五年以下有期徒刑​；加重情節處一年以上七年以下有期徒刑，。
    - **侵害善良風俗：**【違反社會道德與倫理規範的犯罪行為】
        - **妨害風化**：從事或散布違反社會善良風俗之色情行為或物品。
            *加重情節：若以營利為目的或利用科技設備擴散。
            *刑期：公然為猥褻行為者處一年以下有期徒刑、拘役或罰金；意圖營利散布猥褻物者，處二年以下有期徒刑、拘役或罰金。
        - **妨害婚姻**：違反婚姻制度，如重婚、通姦、誘拐配偶等行為。
            *加重情節：若以詐術締結無效婚姻或使婚姻無效。
            *刑期：重婚處五年以下有期徒刑，以詐術締結婚姻者處三年以下有期徒刑​。

- **國家法益：**【危害國家主權、安全與公權力正常運作的犯罪行為】

    - **內亂罪：**【危害國家政權與領土完整的犯罪行為】
        - **內亂**：以暴力或其他非法方式意圖顛覆政府、篡奪國家主權或分裂國土。
        *加重情節：首謀者或煽動多數人參與內亂。
        *刑期：一般行為處七年以上有期徒刑，首謀者處無期徒刑，暴動者可處死刑​。

    - **外患罪：**【危害國家對外安全的犯罪行為】
        - **洩漏國防以外秘密**：非法洩露或交付關於國家安全、利益之機密資訊。
            *加重情節：若洩漏內容嚴重影響國防安全或涉及國際間軍事機密。
            *刑期：一般處三年以上十年以下有期徒刑，情節特重者可處無期徒刑。
        - **外患**：勾結外國或境外勢力，危害中華民國之主權與安全。
            *加重情節：若直接參與敵對行動或指揮多數人共同參與破壞行為。
            *刑期：一般情況處五年以上有期徒刑，情節重大者可處無期徒刑或死刑。

    - **妨害公務：**【妨礙國家機關正常運作的犯罪行為】
        - **妨害秩序**：在公共場所或公眾得出入之場所聚集三人以上，施強暴脅迫者，在場助勢之人。
            *加重情節：攜帶兇器或造成公共危險。
            *刑期：首謀處三年以下有期徒刑、拘役或罰金，從犯處一年以下有期徒刑、拘役或罰金。
        - **妨害公務**：以強暴、脅迫或其他方法妨礙公務員依法執行職務。
            *加重情節：使用動力交通工具、導致重傷或攜帶兇器犯案。
            *刑期：一般處三年以下有期徒刑，加重情節處三年以上十年以下有期徒刑​。
        - **妨害投票**：以詐術或其他非法方法，妨害或影響各類選舉投票之公正性。
            *加重情節：使用暴力或賄賂手段影響選舉結果。
            *刑期：一般處五年以下有期徒刑，加重情節處七年以下有期徒刑​。
        - **瀆職**：公務員濫用職權、圖利自己或他人，或怠忽職守致生損害。
            *加重情節：接受賄賂或濫用職權謀取利益。
            *刑期：一般處一年以上七年以下有期徒刑，得併科罰金​。

    - **偽證與誣告：**【妨害司法正義實現的犯罪行為】
        - **洗錢**：將特定犯罪所得資金進行隱匿或掩飾，以掩蓋其來源或真實性，妨礙或阻撓國家對犯罪所得的調查與追徵，或持有、使用、交易自己或他人的犯罪所得，以達成合法化的目的，或者無正當理由交付、提供三個以上帳戶或帳號。
            *加重情節：涉及超過新台幣一億元的洗錢行為。
            *刑期：一般處六月以上五年以下有期徒刑，併科五千萬元以下罰金；加重情節處三年以上十年以下有期徒刑，併科新台幣一億元以下罰金。
        - **偽證**：於執行審判職務之公署審判時或於檢察官偵查時，證人、鑑定人、通譯於案情有重要關係之事項，供前或供後具結，而為虛偽陳述者。
            *加重情節：涉及重大案件或導致司法錯誤。
            *刑期：一般處七年以下有期徒刑。
        - **誣告**：意圖使他人受刑事處分，而向執法機關為虛假告訴或告發。
            *加重情節：誣告直系血親或尊親屬者，刑期加重至二分之一。
            *刑期：一般處七年以下有期徒刑​
        - **湮滅刑事證據**：意圖使他人受刑事處分或避免刑事處分，而湮滅、偽造、變造、隱匿或湮沒關係案件之證據。
            *加重情節：涉及重大刑事案件或直接導致司法錯誤。
            *刑期：一般處二年以下有期徒刑、拘役或罰金

描述：{query}

### 分析要求：


**步驟1**：分析案件是否涉及多重法益侵害。請**詳細說明**為什麼您認為案件涉及哪些**大類和小類**，並**僅從分類清單中選擇**。
**步驟2**：在進行競合分析前，檢查案件是否具備加重情節。若有加重情節，應根據該情節重新評估罪名的刑期，並在後續的刑罰比較中考慮加重的刑罰等級。
**步驟3**：檢查案件是否存在「競合」情況：

- **法條競合**：如果認為存在法條競合，請**詳細說明理由**，包括為什麼認定為法條競合，以及根據哪些原則選擇適用的法條。
- **想像競合**：如果認為存在想像競合，請**詳細說明理由**，包括為什麼認定為想像競合，以及如何依據「刑罰輕重比較原則」選擇最重的罪名。

**刑罰輕重比較原則：**

一、刑罰的輕重以其**法定主刑**為準，主刑輕重順序為：死刑、無期徒刑、有期徒刑、拘役、罰金。

二、比較時以該罪的**最重主刑**為準，以最高刑度較長或較多者為重（例如：五年有期徒刑重於三年有期徒刑）。

三、若最高刑度相同，則以**最低刑度較長或較多者為重**（例如：五年以下、一年以上有期徒刑重於五年以下有期徒刑）。

四、若**最重主刑**相同，依以下優先順序進行比較：

    1. 無選科刑比有選科刑者為重：即罪名的法定刑只能判處單一刑罰（如僅有期徒刑），沒有替代的刑罰選項，則較重；若有替代刑罰選項（如有期徒刑、拘役或罰金），則較輕。

    2. 有併科刑比無併科刑者為重：即罪名的法定刑可以同時判處多種刑罰（如有期徒刑併科罰金），則較重；若只能判處單一刑罰，則較輕。

    3. 次重主刑較重者為重：若以上比較後仍無法區分，則比較次重主刑（例如，次重刑為拘役或罰金），次重主刑較重者為重。

請依據以上原則，選擇最適合的罪名作為分類結果，並詳細解釋選擇的理由，包括比較過程、選擇依據及每一步選擇的考量因素。

**步驟4**：按照以下格式提供分類結果：

---
**分類結果：**
大類：XXX
小類：XXX
---
### 範例一（涉及多重法益侵害）：

描述：

"歹徒持刀搶劫超商，並在過程中導致店員受傷。"

**分析過程：**

**步驟1**：本案涉及多重法益侵害：

- **個人法益**：
  - **侵害財產**：強盜（重罪）。**理由**：歹徒持刀威脅並奪取超商財物，符合強盜罪中「以強暴、脅迫等方法強取他人財物」的定義。
    - *加重情節：若行為導致他人重傷或死亡，即屬加重情節。在此情境下，若店員受重傷可適用。 
  - **侵害身體**：傷害（輕罪）。**理由**：在搶劫過程中，店員受傷，符合傷害罪中「對他人身體造成傷害」的定義。

**步驟2**：競合分析：

- **想像競合**：因為同一行為同時侵害了多個法益（財產和身體），觸犯了強盜罪和傷害罪。
- **刑罰輕重比較**：
  - **強盜罪**：主刑為有期徒刑五年以上（重罪）。
  - **傷害罪**：主刑為五年以下有期徒刑、拘役或罰金（輕罪）。
- **理由**：根據「刑罰輕重比較原則」，強盜罪的法定刑度較重，因此選擇強盜罪作為分類結果。

**分類結果：**

大類：個人法益

小類：強盜

---

### 範例二（不涉及多重法益侵害）：

描述：

"某人未經允許，秘密取走他人放在辦公室桌上的手機。"

**分析過程：**

**步驟1**：本案涉及的法益：

- **個人法益**：
  - **侵害財產**：竊盜。**理由**：未經允許秘密取走他人財物，符合竊盜罪中「竊取他人之動產」的定義。
    -*加重情節：此情境不包含加重情節，例如使用暴力或攜帶兇器等。 

**步驟2**：競合分析：

- **無競合情況**：此行為僅觸犯竊盜罪，沒有涉及其他罪名或法益。
- **理由**：沒有其他行為同時侵害不同的法益或觸犯多個法條。

**分類結果：**

大類：個人法益

小類：竊盜

---



**提示**：

1. **必須從分類清單中選擇大類和小類**。
2. 若案件描述不清楚，請返回「案件描述不清楚，請提供更多資訊。」。
3. 必須先確定大類，再在大類內選擇一個最適合的小類作為最終結果。
4. 雖然可能涉及多個法益，但需依據競合原則選擇**一個最主要的罪名**作為分類結果。
5. 若為「法條競合」案件，請依據適用優先順序選擇最適合的法條。
6. **所有分析應基於提供的案件描述和分類清單，不得添加未經提供的資訊或主觀推測**。
7. 若無法確定法定刑度，請依據一般法律常識和罪名的嚴重性進行比較。
8. **在分析過程中，請詳細說明每個步驟的推理和選擇理由**。
"""





    response = client.chat.completions.create(
    model="gpt-4o-2024-08-06",
    #model = "o1-preview-2024-09-12",
    messages=[
        {"role": "system", "content": prompt},
        {"role": "user", "content": query}
    ],
    max_tokens=750,  # 增加 max_tokens 以獲取完整的回應
    temperature=0.00000001,  
)
    return response.choices[0].message.content.strip()
    # assistant_reply = response.choices[0].message.content.strip()

    # # 使用正則表達式提取小類
    # match = re.search(r"小類\s*[:：]\s*(.+)", assistant_reply)
    # if match:
    #     small_category = match.group(1).strip()
    #     return small_category
    # else:
    #     print("未找到小類信息，請確認輸出格式。")
    #     return None
def CoT_prompt(query): #80／20法則：刑法試在．必刑《分則篇》
    prompt = """
    **請根據以下描述，選擇最相關的小類，並按照以下格式提供分類結果。**

### 分類清單（請嚴格按照以下分類進行）：

- **個人法益：**【保護個人的基本權利與利益，包括生命、身體、自由、名譽、財產等】

    - **侵害生命：**【危害他人生命權的犯罪行為】
        - **殺人**：故意非法剝奪他人生命，包括直接故意或間接故意致人死亡的行為。
            *加重情節*：對直系血親尊親屬行凶，或伴隨暴力行為、計畫性犯案者。
            *刑期*：處死刑、無期徒刑或十年以上有期徒刑。

        - **過失致死**：因疏忽或未盡注意義務導致他人死亡。
            *加重情節*：在公共場合或高風險環境違規操作導致他人死亡。
            *刑期*：處五年以下有期徒刑、拘役或罰金。
        
        - **傷害致死**：對他人施加傷害，最終導致死亡。
            *加重情節*：未及時提供救助或故意阻礙他人救助，或對無抵抗能力者施暴致死。
            *刑期*：處三年以上十年以下有期徒刑，情節特重可至十五年。
        
        - **遺棄**：遺棄無自救能力者或應扶養之人，使其陷於生命或健康危險。
            *加重情節*：遺棄行為致人死亡，或遺棄身心障礙者、未成年人等特殊群體。
            *刑期*：一般處三年以下有期徒刑、拘役或罰金；若致死，處五年以上有期徒刑。

    - **侵害身體：**【危害他人身體完整性與健康的犯罪行為】
        - **傷害**：非法對他人身體施加傷害，導致肢體損傷或健康受損。
            *加重情節*：若導致重傷或對直系血親尊親屬施暴。
            *刑期*：處五年以下有期徒刑、拘役或罰金。致重傷者處三年以上十年以下有期徒刑​。
        - **重傷害**：造成他人身體嚴重損害，如失明、失聰、毀容、肢體殘廢等永久性傷害。
            *加重情節*：因重傷而導致死亡。
            *刑期*：處五年以上十二年以下有期徒刑，若致死處無期徒刑或十年以上有期徒刑。
        - **過失傷害**：因過失而非故意造成他人身體受傷或健康損害。
            *加重情節*：在公共場合或高風險環境中未遵守安全規範。
            *刑期*：處一年以下有期徒刑、拘役或罰金；致重傷者處三年以下有期徒刑。

    - **侵害自由：**【侵犯他人人身自由與基本權利的犯罪行為】
        - **妨害秘密**：未經同意，非法利用工具或設備窺視、竊聽、錄音、錄影、拍攝或記錄他人非公開的活動、言論、談話或隱私部位，藉此侵犯個人隱私權。
            *加重情節：若利用電腦等科技設備進行，刑期加重至二分之一。
            *刑期：處一年以下有期徒刑、拘役或罰金。
        - **強制**：以強暴、脅迫、藥劑、催眠術等方法使別人做無義務之事，或妨礙他人行使權利。
            *加重情節：對弱勢群體或多人共同實施該行為。
            *刑期：處三年以下有期徒刑、拘役或罰金。
        - **妨害自由**：非法逮捕、監禁、剝奪、限制他人行動自由或意思表達自由。
            *加重情節：導致被害人死亡或重傷。
            *刑期：一般情況處五年以下有期徒刑、拘役或罰金；致死者處無期徒刑或七年以上有期徒刑。
        - **恐嚇**：以加害生命、身體、自由、名譽、財產之事恐嚇他人，致生危害於安全者。
            *刑期：處二年以下有期徒刑、拘役或九千元以下罰金。
        - **妨害性自主**：違反他人意願而為之性行為，包括強制性交、猥褻等行為。
            *加重情節：對未成年人、殘障人士或攜帶武器進行。
            *一般性行為處三年以上十年以下有期徒刑；符合加重情節者，處七年以上有期徒刑。

    - **侵害名譽信用：**【損害他人社會評價與經濟信用的犯罪行為】
        - **誹謗**：散布不實言論或文字，足以貶損他人名譽或使他人受社會評價降低。
            *加重情節：若以文字、圖畫等形式散布，刑期加重至二分之一。
            *刑期：處一年以下有期徒刑、拘役或一萬五千元以下罰金；若散布文字、圖畫，處二年以下有期徒刑、拘役或三萬元以下罰金。
        - **侮辱**：以言語、文字或行為公然貶低他人人格，損害其尊嚴。
            *加重情節：使用暴力手段侮辱他人。
            *刑期：一般處拘役或九千元以下罰金；使用暴力者處一年以下有期徒刑、拘役或一萬五千元以下罰金​。
        - **妨害信用**：惡意損害他人或企業之商業信用或經濟信用。
            *加重情節：透過電視、網際網路等媒體散布，刑期加重至二分之一。
            *刑期：處二年以下有期徒刑、拘役或科或併科二十萬元以下罰金。

    - **侵害財產：**【非法侵害他人財產權益的犯罪行為】
        - **竊盜**：意圖為自己或第三人不法之所有，竊取他人之動產。
            *加重情節：侵入住宅、攜帶兇器、結夥多人或乘災害之際犯案。
            *刑期：處五年以下有期徒刑、拘役或罰金，加重情節處六月以上五年以下有期徒刑​。
        - **侵占**：意圖為自己或第三人不法之所有，將自己持有他人之物據為己有。
            *加重情節：加重情節：對於公務上或公益所持有的物品犯案。
            *刑期：一般處五年以下有期徒刑、拘役或罰金，加重情節處一年以上七年以下有期徒刑​。
        - **搶奪**：意圖為自己或第三人不法之所有，以當場施強暴或脅迫手段奪取他人財物。
            *加重情節：致人重傷或死亡。
            *刑期：處無期徒刑或七年以上有期徒刑，致人重傷者處三年以上十年以下有期徒刑。
        - **強盜**：意圖為自己或第三人不法之所有，以強暴、脅迫、藥劑、催眠術等方法強取他人財物。
            *加重情節：導致他人重傷、死亡，或伴隨強制性交或擄人勒贖。
            *刑期：處五年以上有期徒刑，致人死亡或重傷可處死刑或無期徒刑。
        - **贓物**：收受、搬運、寄藏、故買贓物或媒介者。因贓物變得之財物，以贓物論。
            *刑期：處五年以下有期徒刑、拘役或科或併科五十萬元以下罰金。
        - **詐欺**：利用欺罔或詐術使人陷於錯誤而交付財物或獲取不法利益。
            *加重情節*：一、冒用政府機關或公務員名義犯之；二、三人以上共同詐欺；三、以廣播電視、電子通訊、網際網路或其他媒體等傳播工具，對公眾散布而犯之；四、以電腦合成、製作關於他人不實影像、聲音或電磁紀錄之方法犯之。
            *刑期*：一般情況處五年以下有期徒刑、拘役或罰金；加重情節處一年以上七年以下有期徒刑。
        - **重利**：收取超過法定利率的高額利息，危害他人財產利益。
            *加重情節：以威脅、暴力等手段強迫他人支付高額利息。
            *刑期：處三年以下有期徒刑、拘役或科或併科九萬元以下罰金。
        - **毀損財產**：故意破壞、損壞他人之動產或不動產。
            *加重情節：毀損公共設施或造成重大經濟損失。
            *刑期：一般情況處二年以下有期徒刑、拘役或罰金。
        - **侵入住宅**：未經合法授權，擅自進入他人住宅，或在他人住宅內逗留。
            *加重情節：無加重情節。
            *刑期：處一年以下有期徒刑、拘役或罰金。
        - **妨害電腦使用**：指未經授權的非法行為，包括無故輸入他人帳號密碼、破解電腦之保護措施、利用系統漏洞或其他方式入侵他人電腦系統或其相關設備。此類行為可能涉及瀏覽、竊取或篡改資料，破壞或干擾電腦設備、網路運作，甚至散播惡意程式（如病毒、木馬程式）、進行分散式阻斷服務（DDoS）攻擊、偽造或操控數據等，導致系統異常或中斷。該行為可能侵犯個人隱私、導致資料外洩或造成重大經濟損失，並涉及法律責任。
            *加重情節：造成他人系統設備或資料永久損毀、資料遺失或資料外洩；對於重要公共系統（如金融、醫療、交通等）進行攻擊或干擾，造成公共安全或大範圍經濟損失；多次或大規模散播惡意程式，對於國家關鍵基礎設施進行攻擊；行為人利用高階科技設備或多重入侵手段進行行為，增加追查困難度。
            *刑期：一般情況處三年以下有期徒刑或科或併科三十萬元以下罰金；加重情節刑期可加重至五年以下有期徒刑，並得併科六十萬以下罰金。

- **社會法益：**【保護社會公共利益與秩序，維護社會正常運作】

    - **侵害公共安全：**【危害社會大眾生命財產安全的犯罪行為】
        - **公共危險**：實施危害不特定多數人生命、身體或財產安全的行為，如縱火、決水、放流毒物、危險駕駛等。
            *加重情節：若因行為致人重傷或死亡，或對重要公共設施、場所施加危險行為。
            *刑期：一般處五年以下有期徒刑、拘役或罰金；若致人於死者，處無期徒刑或七年以上有期徒刑；致重傷者，處三年以上十年以下有期徒刑。
    - **侵害公共信用與交易安全：**【破壞社會經濟秩序與交易安全的犯罪行為】
        - **偽造貨幣**：仿造、變造貨幣或使用偽造之貨幣，破壞國家金融秩序。
            *加重情節：製造假幣流通至大範圍或涉及大額交易。
            *刑期：一般處五年以上有期徒刑，並得併科罰金。
        - **偽造有價證券**：仿造、變造股票、公司債券等有價證券，危害金融交易安全。
            *加重情節：大規模偽造並流通，造成金融損失。
            *刑期：處三年以上十年以下有期徒刑，得併科罰金。
        - **偽造文書**：指偽造或變造各類公文書、私文書以及「準私文書」。「準私文書」包括在紙張、物品上製作或修改的文字、符號、圖畫、照片，亦包含使用錄音、錄影或電磁紀錄等數位媒體表達特定意圖的記錄。此類行為若足以對公眾或他人造成損害，影響文書或記錄的公信力和證據效力，即構成偽造文書罪。
            *加重情節：偽造政府公文。
            *刑期：一般處五年以下有期徒刑​；加重情節處一年以上七年以下有期徒刑，。
    - **侵害善良風俗：**【違反社會道德與倫理規範的犯罪行為】
        - **妨害風化**：從事或散布違反社會善良風俗之色情行為或物品。
            *加重情節：若以營利為目的或利用科技設備擴散。
            *刑期：公然為猥褻行為者處一年以下有期徒刑、拘役或罰金；意圖營利散布猥褻物者，處二年以下有期徒刑、拘役或罰金。
        - **妨害婚姻**：違反婚姻制度，如重婚、通姦、誘拐配偶等行為。
            *加重情節：若以詐術締結無效婚姻或使婚姻無效。
            *刑期：重婚處五年以下有期徒刑，以詐術締結婚姻者處三年以下有期徒刑​。

- **國家法益：**【危害國家主權、安全與公權力正常運作的犯罪行為】

    - **內亂罪：**【危害國家政權與領土完整的犯罪行為】
        - **內亂**：以暴力或其他非法方式意圖顛覆政府、篡奪國家主權或分裂國土。
        *加重情節：首謀者或煽動多數人參與內亂。
        *刑期：一般行為處七年以上有期徒刑，首謀者處無期徒刑，暴動者可處死刑​。

    - **外患罪：**【危害國家對外安全的犯罪行為】
        - **洩漏國防以外秘密**：非法洩露或交付關於國家安全、利益之機密資訊。
            *加重情節：若洩漏內容嚴重影響國防安全或涉及國際間軍事機密。
            *刑期：一般處三年以上十年以下有期徒刑，情節特重者可處無期徒刑。
        - **外患**：勾結外國或境外勢力，危害中華民國之主權與安全。
            *加重情節：若直接參與敵對行動或指揮多數人共同參與破壞行為。
            *刑期：一般情況處五年以上有期徒刑，情節重大者可處無期徒刑或死刑。

    - **妨害公務：**【妨礙國家機關正常運作的犯罪行為】
        - **妨害秩序**：在公共場所或公眾得出入之場所聚集三人以上，施強暴脅迫者，在場助勢之人。
            *加重情節：攜帶兇器或造成公共危險。
            *刑期：首謀處三年以下有期徒刑、拘役或罰金，從犯處一年以下有期徒刑、拘役或罰金。
        - **妨害公務**：以強暴、脅迫或其他方法妨礙公務員依法執行職務。
            *加重情節：使用動力交通工具、導致重傷或攜帶兇器犯案。
            *刑期：一般處三年以下有期徒刑，加重情節處三年以上十年以下有期徒刑​。
        - **妨害投票**：以詐術或其他非法方法，妨害或影響各類選舉投票之公正性。
            *加重情節：使用暴力或賄賂手段影響選舉結果。
            *刑期：一般處五年以下有期徒刑，加重情節處七年以下有期徒刑​。
        - **瀆職**：公務員濫用職權、圖利自己或他人，或怠忽職守致生損害。
            *加重情節：接受賄賂或濫用職權謀取利益。
            *刑期：一般處一年以上七年以下有期徒刑，得併科罰金​。

    - **偽證與誣告：**【妨害司法正義實現的犯罪行為】
        - **洗錢**：將特定犯罪所得資金進行隱匿或掩飾，以掩蓋其來源或真實性，妨礙或阻撓國家對犯罪所得的調查與追徵，或持有、使用、交易自己或他人的犯罪所得，以達成合法化的目的，或者無正當理由交付、提供三個以上帳戶或帳號。
            *加重情節：涉及超過新台幣一億元的洗錢行為。
            *刑期：一般處六月以上五年以下有期徒刑，併科五千萬元以下罰金；加重情節處三年以上十年以下有期徒刑，併科新台幣一億元以下罰金。
        - **偽證**：於執行審判職務之公署審判時或於檢察官偵查時，證人、鑑定人、通譯於案情有重要關係之事項，供前或供後具結，而為虛偽陳述者。
            *加重情節：涉及重大案件或導致司法錯誤。
            *刑期：一般處七年以下有期徒刑。
        - **誣告**：意圖使他人受刑事處分，而向執法機關為虛假告訴或告發。
            *加重情節：誣告直系血親或尊親屬者，刑期加重至二分之一。
            *刑期：一般處七年以下有期徒刑​
        - **湮滅刑事證據**：意圖使他人受刑事處分或避免刑事處分，而湮滅、偽造、變造、隱匿或湮沒關係案件之證據。
            *加重情節：涉及重大刑事案件或直接導致司法錯誤。
            *刑期：一般處二年以下有期徒刑、拘役或罰金

    描述：{query}

    ### 要求：
    步驟1：從分類清單中選擇一個最相關的類別。
    步驟2：基於描述進行推理，提供行為分析與法律條文匹配的過程，並按照以下格式提供分類結果：

    推理過程：包括行為分析和法律條文匹配的簡要說明。
    分類結果：只返回一個最相關的小類。

    ---

    ### 範例：
    描述：
    "歹徒持刀搶劫超商，並在過程中導致店員受傷。"

    推理過程：
    行為分析：描述涉及持刀威脅並奪取財物的行為。
    法律條文匹配：根據分類清單，符合「強盜」。

    分類結果：
    強盜

    ### 範例：
    描述：
    "某人未經允許，秘密取走他人放在辦公室桌上的手機。"

    推理過程：
    行為分析：描述涉及未經允許秘密取走他人財物的行為。
    法律條文匹配：根據分類清單，符合「竊盜」。

    分類結果：
    竊盜

    **提示**：如果描述不清楚或無法明確分類，請返回「案件描述不清楚，請提供更多資訊。」。

    """


    response = client.chat.completions.create(
        model="gpt-4o-2024-08-06",
        messages=[
            {"role": "system", "content": prompt},
            {"role": "user", "content": query}
        ],
        max_tokens=750,
        temperature=0.00000001,  
    )
    return response.choices[0].message.content.strip()
def LoT_prompt(query): #80／20法則：刑法試在．必刑《分則篇》
    prompt = """
    在司法三段論中，大前提是具體的法律規範，小前提是案件事實，結論是判決結果。
    請根據以下案例，使用司法三段論進行分析，並按照以下格式輸出結果。最終結論僅選擇一個最符合案件事實或最嚴重的罪名作為輸出。

    **範例輸出格式：**
    Major premise: [引用的法律條文或規範]
    Minor premise: [案件中的具體事實描述]
    Conclusion: [被告構成的唯一罪名]

    **範例：**
    Case: A kicked B to the ground, and A used coercion to rob the victim of a cell phone, which was worth RMB 840 yuan.

    Major premise: According to the Criminal Law of the Republic of China, constitutes the crime of robbery, shall be sentenced to imprisonment for a term of not less than three years and not more than ten years.
    Minor premise: A kicked B to the ground, and A used coercion to rob the victim of a cell phone, which was worth RMB 840 yuan.
    Conclusion: A constitutes the crime of robbery.

    **請分析以下案例並生成對應的結果：**
    Case: {query}
"""



    response = client.chat.completions.create(
        model="gpt-4o-2024-08-06",
        messages=[
            {"role": "system", "content": prompt},
            {"role": "user", "content": query}
        ],
        max_tokens=750,
        temperature=0.00000001,  
    )
    return response.choices[0].message.content.strip()
def direct_answer_prompt(query):
    prompt = """
    **請根據以下描述，選擇最相關的小類，並按照以下格式提供分類結果。**

### 分類清單（請嚴格按照以下分類進行）：

- **個人法益：**【保護個人的基本權利與利益，包括生命、身體、自由、名譽、財產等】

    - **侵害生命：**【危害他人生命權的犯罪行為】
        - **殺人**：故意非法剝奪他人生命，包括直接故意或間接故意致人死亡的行為。
            *加重情節*：對直系血親尊親屬行凶，或伴隨暴力行為、計畫性犯案者。
            *刑期*：處死刑、無期徒刑或十年以上有期徒刑。

        - **過失致死**：因疏忽或未盡注意義務導致他人死亡。
            *加重情節*：在公共場合或高風險環境違規操作導致他人死亡。
            *刑期*：處五年以下有期徒刑、拘役或罰金。
        
        - **傷害致死**：對他人施加傷害，最終導致死亡。
            *加重情節*：未及時提供救助或故意阻礙他人救助，或對無抵抗能力者施暴致死。
            *刑期*：處三年以上十年以下有期徒刑，情節特重可至十五年。
        
        - **遺棄**：遺棄無自救能力者或應扶養之人，使其陷於生命或健康危險。
            *加重情節*：遺棄行為致人死亡，或遺棄身心障礙者、未成年人等特殊群體。
            *刑期*：一般處三年以下有期徒刑、拘役或罰金；若致死，處五年以上有期徒刑。

    - **侵害身體：**【危害他人身體完整性與健康的犯罪行為】
        - **傷害**：非法對他人身體施加傷害，導致肢體損傷或健康受損。
            *加重情節*：若導致重傷或對直系血親尊親屬施暴。
            *刑期*：處五年以下有期徒刑、拘役或罰金。致重傷者處三年以上十年以下有期徒刑​。
        - **重傷害**：造成他人身體嚴重損害，如失明、失聰、毀容、肢體殘廢等永久性傷害。
            *加重情節*：因重傷而導致死亡。
            *刑期*：處五年以上十二年以下有期徒刑，若致死處無期徒刑或十年以上有期徒刑。
        - **過失傷害**：因過失而非故意造成他人身體受傷或健康損害。
            *加重情節*：在公共場合或高風險環境中未遵守安全規範。
            *刑期*：處一年以下有期徒刑、拘役或罰金；致重傷者處三年以下有期徒刑。

    - **侵害自由：**【侵犯他人人身自由與基本權利的犯罪行為】
        - **妨害秘密**：未經同意，非法利用工具或設備窺視、竊聽、錄音、錄影、拍攝或記錄他人非公開的活動、言論、談話或隱私部位，藉此侵犯個人隱私權。
            *加重情節：若利用電腦等科技設備進行，刑期加重至二分之一。
            *刑期：處一年以下有期徒刑、拘役或罰金。
        - **強制**：以強暴、脅迫、藥劑、催眠術等方法使別人做無義務之事，或妨礙他人行使權利。
            *加重情節：對弱勢群體或多人共同實施該行為。
            *刑期：處三年以下有期徒刑、拘役或罰金。
        - **妨害自由**：非法逮捕、監禁、剝奪、限制他人行動自由或意思表達自由。
            *加重情節：導致被害人死亡或重傷。
            *刑期：一般情況處五年以下有期徒刑、拘役或罰金；致死者處無期徒刑或七年以上有期徒刑。
        - **恐嚇**：以加害生命、身體、自由、名譽、財產之事恐嚇他人，致生危害於安全者。
            *刑期：處二年以下有期徒刑、拘役或九千元以下罰金。
        - **妨害性自主**：違反他人意願而為之性行為，包括強制性交、猥褻等行為。
            *加重情節：對未成年人、殘障人士或攜帶武器進行。
            *一般性行為處三年以上十年以下有期徒刑；符合加重情節者，處七年以上有期徒刑。

    - **侵害名譽信用：**【損害他人社會評價與經濟信用的犯罪行為】
        - **誹謗**：散布不實言論或文字，足以貶損他人名譽或使他人受社會評價降低。
            *加重情節：若以文字、圖畫等形式散布，刑期加重至二分之一。
            *刑期：處一年以下有期徒刑、拘役或一萬五千元以下罰金；若散布文字、圖畫，處二年以下有期徒刑、拘役或三萬元以下罰金。
        - **侮辱**：以言語、文字或行為公然貶低他人人格，損害其尊嚴。
            *加重情節：使用暴力手段侮辱他人。
            *刑期：一般處拘役或九千元以下罰金；使用暴力者處一年以下有期徒刑、拘役或一萬五千元以下罰金​。
        - **妨害信用**：惡意損害他人或企業之商業信用或經濟信用。
            *加重情節：透過電視、網際網路等媒體散布，刑期加重至二分之一。
            *刑期：處二年以下有期徒刑、拘役或科或併科二十萬元以下罰金。

    - **侵害財產：**【非法侵害他人財產權益的犯罪行為】
        - **竊盜**：意圖為自己或第三人不法之所有，竊取他人之動產。
            *加重情節：侵入住宅、攜帶兇器、結夥多人或乘災害之際犯案。
            *刑期：處五年以下有期徒刑、拘役或罰金，加重情節處六月以上五年以下有期徒刑​。
        - **侵占**：意圖為自己或第三人不法之所有，將自己持有他人之物據為己有。
            *加重情節：加重情節：對於公務上或公益所持有的物品犯案。
            *刑期：一般處五年以下有期徒刑、拘役或罰金，加重情節處一年以上七年以下有期徒刑​。
        - **搶奪**：意圖為自己或第三人不法之所有，以當場施強暴或脅迫手段奪取他人財物。
            *加重情節：致人重傷或死亡。
            *刑期：處無期徒刑或七年以上有期徒刑，致人重傷者處三年以上十年以下有期徒刑。
        - **強盜**：意圖為自己或第三人不法之所有，以強暴、脅迫、藥劑、催眠術等方法強取他人財物。
            *加重情節：導致他人重傷、死亡，或伴隨強制性交或擄人勒贖。
            *刑期：處五年以上有期徒刑，致人死亡或重傷可處死刑或無期徒刑。
        - **贓物**：收受、搬運、寄藏、故買贓物或媒介者。因贓物變得之財物，以贓物論。
            *刑期：處五年以下有期徒刑、拘役或科或併科五十萬元以下罰金。
        - **詐欺**：利用欺罔或詐術使人陷於錯誤而交付財物或獲取不法利益。
            *加重情節*：一、冒用政府機關或公務員名義犯之；二、三人以上共同詐欺；三、以廣播電視、電子通訊、網際網路或其他媒體等傳播工具，對公眾散布而犯之；四、以電腦合成、製作關於他人不實影像、聲音或電磁紀錄之方法犯之。
            *刑期*：一般情況處五年以下有期徒刑、拘役或罰金；加重情節處一年以上七年以下有期徒刑。
        - **重利**：收取超過法定利率的高額利息，危害他人財產利益。
            *加重情節：以威脅、暴力等手段強迫他人支付高額利息。
            *刑期：處三年以下有期徒刑、拘役或科或併科九萬元以下罰金。
        - **毀損財產**：故意破壞、損壞他人之動產或不動產。
            *加重情節：毀損公共設施或造成重大經濟損失。
            *刑期：一般情況處二年以下有期徒刑、拘役或罰金。
        - **侵入住宅**：未經合法授權，擅自進入他人住宅，或在他人住宅內逗留。
            *加重情節：無加重情節。
            *刑期：處一年以下有期徒刑、拘役或罰金。
        - **妨害電腦使用**：指未經授權的非法行為，包括無故輸入他人帳號密碼、破解電腦之保護措施、利用系統漏洞或其他方式入侵他人電腦系統或其相關設備。此類行為可能涉及瀏覽、竊取或篡改資料，破壞或干擾電腦設備、網路運作，甚至散播惡意程式（如病毒、木馬程式）、進行分散式阻斷服務（DDoS）攻擊、偽造或操控數據等，導致系統異常或中斷。該行為可能侵犯個人隱私、導致資料外洩或造成重大經濟損失，並涉及法律責任。
            *加重情節：造成他人系統設備或資料永久損毀、資料遺失或資料外洩；對於重要公共系統（如金融、醫療、交通等）進行攻擊或干擾，造成公共安全或大範圍經濟損失；多次或大規模散播惡意程式，對於國家關鍵基礎設施進行攻擊；行為人利用高階科技設備或多重入侵手段進行行為，增加追查困難度。
            *刑期：一般情況處三年以下有期徒刑或科或併科三十萬元以下罰金；加重情節刑期可加重至五年以下有期徒刑，並得併科六十萬以下罰金。

- **社會法益：**【保護社會公共利益與秩序，維護社會正常運作】

    - **侵害公共安全：**【危害社會大眾生命財產安全的犯罪行為】
        - **公共危險**：實施危害不特定多數人生命、身體或財產安全的行為，如縱火、決水、放流毒物、危險駕駛等。
            *加重情節：若因行為致人重傷或死亡，或對重要公共設施、場所施加危險行為。
            *刑期：一般處五年以下有期徒刑、拘役或罰金；若致人於死者，處無期徒刑或七年以上有期徒刑；致重傷者，處三年以上十年以下有期徒刑。
    - **侵害公共信用與交易安全：**【破壞社會經濟秩序與交易安全的犯罪行為】
        - **偽造貨幣**：仿造、變造貨幣或使用偽造之貨幣，破壞國家金融秩序。
            *加重情節：製造假幣流通至大範圍或涉及大額交易。
            *刑期：一般處五年以上有期徒刑，並得併科罰金。
        - **偽造有價證券**：仿造、變造股票、公司債券等有價證券，危害金融交易安全。
            *加重情節：大規模偽造並流通，造成金融損失。
            *刑期：處三年以上十年以下有期徒刑，得併科罰金。
        - **偽造文書**：指偽造或變造各類公文書、私文書以及「準私文書」。「準私文書」包括在紙張、物品上製作或修改的文字、符號、圖畫、照片，亦包含使用錄音、錄影或電磁紀錄等數位媒體表達特定意圖的記錄。此類行為若足以對公眾或他人造成損害，影響文書或記錄的公信力和證據效力，即構成偽造文書罪。
            *加重情節：偽造政府公文。
            *刑期：一般處五年以下有期徒刑​；加重情節處一年以上七年以下有期徒刑，。
    - **侵害善良風俗：**【違反社會道德與倫理規範的犯罪行為】
        - **妨害風化**：從事或散布違反社會善良風俗之色情行為或物品。
            *加重情節：若以營利為目的或利用科技設備擴散。
            *刑期：公然為猥褻行為者處一年以下有期徒刑、拘役或罰金；意圖營利散布猥褻物者，處二年以下有期徒刑、拘役或罰金。
        - **妨害婚姻**：違反婚姻制度，如重婚、通姦、誘拐配偶等行為。
            *加重情節：若以詐術締結無效婚姻或使婚姻無效。
            *刑期：重婚處五年以下有期徒刑，以詐術締結婚姻者處三年以下有期徒刑​。

- **國家法益：**【危害國家主權、安全與公權力正常運作的犯罪行為】

    - **內亂罪：**【危害國家政權與領土完整的犯罪行為】
        - **內亂**：以暴力或其他非法方式意圖顛覆政府、篡奪國家主權或分裂國土。
        *加重情節：首謀者或煽動多數人參與內亂。
        *刑期：一般行為處七年以上有期徒刑，首謀者處無期徒刑，暴動者可處死刑​。

    - **外患罪：**【危害國家對外安全的犯罪行為】
        - **洩漏國防以外秘密**：非法洩露或交付關於國家安全、利益之機密資訊。
            *加重情節：若洩漏內容嚴重影響國防安全或涉及國際間軍事機密。
            *刑期：一般處三年以上十年以下有期徒刑，情節特重者可處無期徒刑。
        - **外患**：勾結外國或境外勢力，危害中華民國之主權與安全。
            *加重情節：若直接參與敵對行動或指揮多數人共同參與破壞行為。
            *刑期：一般情況處五年以上有期徒刑，情節重大者可處無期徒刑或死刑。

    - **妨害公務：**【妨礙國家機關正常運作的犯罪行為】
        - **妨害秩序**：在公共場所或公眾得出入之場所聚集三人以上，施強暴脅迫者，在場助勢之人。
            *加重情節：攜帶兇器或造成公共危險。
            *刑期：首謀處三年以下有期徒刑、拘役或罰金，從犯處一年以下有期徒刑、拘役或罰金。
        - **妨害公務**：以強暴、脅迫或其他方法妨礙公務員依法執行職務。
            *加重情節：使用動力交通工具、導致重傷或攜帶兇器犯案。
            *刑期：一般處三年以下有期徒刑，加重情節處三年以上十年以下有期徒刑​。
        - **妨害投票**：以詐術或其他非法方法，妨害或影響各類選舉投票之公正性。
            *加重情節：使用暴力或賄賂手段影響選舉結果。
            *刑期：一般處五年以下有期徒刑，加重情節處七年以下有期徒刑​。
        - **瀆職**：公務員濫用職權、圖利自己或他人，或怠忽職守致生損害。
            *加重情節：接受賄賂或濫用職權謀取利益。
            *刑期：一般處一年以上七年以下有期徒刑，得併科罰金​。

    - **偽證與誣告：**【妨害司法正義實現的犯罪行為】
        - **洗錢**：將特定犯罪所得資金進行隱匿或掩飾，以掩蓋其來源或真實性，妨礙或阻撓國家對犯罪所得的調查與追徵，或持有、使用、交易自己或他人的犯罪所得，以達成合法化的目的，或者無正當理由交付、提供三個以上帳戶或帳號。
            *加重情節：涉及超過新台幣一億元的洗錢行為。
            *刑期：一般處六月以上五年以下有期徒刑，併科五千萬元以下罰金；加重情節處三年以上十年以下有期徒刑，併科新台幣一億元以下罰金。
        - **偽證**：於執行審判職務之公署審判時或於檢察官偵查時，證人、鑑定人、通譯於案情有重要關係之事項，供前或供後具結，而為虛偽陳述者。
            *加重情節：涉及重大案件或導致司法錯誤。
            *刑期：一般處七年以下有期徒刑。
        - **誣告**：意圖使他人受刑事處分，而向執法機關為虛假告訴或告發。
            *加重情節：誣告直系血親或尊親屬者，刑期加重至二分之一。
            *刑期：一般處七年以下有期徒刑​
        - **湮滅刑事證據**：意圖使他人受刑事處分或避免刑事處分，而湮滅、偽造、變造、隱匿或湮沒關係案件之證據。
            *加重情節：涉及重大刑事案件或直接導致司法錯誤。
            *刑期：一般處二年以下有期徒刑、拘役或罰金

    描述：{query}

    ### 要求：
    請從分類清單中選擇一個最相關的小類，並直接返回分類結果。

    ---

    ### 範例：
    描述：
    "歹徒持刀搶劫超商，並在過程中導致店員受傷。"

    分類結果：
    強盜

    ### 範例：
    描述：
    "某人未經允許，秘密取走他人放在辦公室桌上的手機。"


    分類結果：
    竊盜

    **提示**：如果描述不清楚或無法明確分類，請返回「案件描述不清楚，請提供更多資訊。」。

    """


    response = client.chat.completions.create(
        model="gpt-4o-2024-08-06",
        messages=[
            {"role": "system", "content": prompt},
            {"role": "user", "content": query}
        ],
        max_tokens=10,
        temperature=0.00000001,  
    )
    return response.choices[0].message.content.strip()
def run_experiment():
    # Load the data from the excel
    df = load_data()
    
    # Create lists to store results
    two_prompt_results = []
    CoT_prompt_results = []
    LoT_prompt_results = []
    direct_answer_prompt_results = []
    for index, row in df.iterrows():
        
        query = row['犯罪事實']
        result_two = two_prompt(query)
        #result_CoT = CoT_prompt(query)
        #result_LoT = LoT_prompt(query)
        #result_direct_answer = direct_answer_prompt(query)

        # Store results
        two_prompt_results.append(result_two)
        #CoT_prompt_results.append(result_CoT)
        #LoT_prompt_results.append(result_LoT)
        #direct_answer_prompt_results.append(result_direct_answer)
        #print(f"案件 {index + 1} 處理完成")

    # Add results to the dataframe
    #df['三層分類結果'] = three_prompt_results
    #df = df.iloc[:30]
    df['兩層分類結果'] = two_prompt_results
    #df['一層分類結果'] = CoT_prompt_results
    #df['無一層分類結果'] = LoT_prompt_results
    #df['直接回答'] = direct_answer_prompt_results
    # Save results to a new Excel file
    output_file = 'test_1.xlsx'
    
    df.to_excel(output_file, index=False)
    print(f"結果已保存到 {output_file}")

if __name__ == "__main__":
    run_experiment()


